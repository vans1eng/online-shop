<template>
    <div class="right-buy-box" ref="rightBuyBox">
        <div class="goods-name-box">
            <span class="goods-name">华强北蓝牙耳机Pro3官方正品无线第三代2025新款政府补贴心率降噪</span>
        </div>
        <div class="goods-custom-tag-box">
            <span class="goods-custom-tag">多人评价"音质特别好"</span>
            <span class="goods-custom-tag">超2千人加购"</span>
        </div>
        <div class="goods-price-box">
            <span class="goods-price-unit">￥<span class="goods-price-value">1688</span></span>
            <span class="goods-sales">已售<span class="goods-sales-value">400+</span></span>
        </div>
        <div class="goods-price-tag-box">
            <span class="goods-price-tag">国家贴息3期免息</span>
        </div>
        <div class="goods-buy-tag-box">
            <div class="goods-delivery-tag-box">
                <svg t="1762180787932" class="icon" viewBox="0 0 1024 1024" version="1.1"
                    xmlns="http://www.w3.org/2000/svg" p-id="6163" width="200" height="200">
                    <path
                        d="M128.896 736H96a32 32 0 0 1-32-32V224a32 32 0 0 1 32-32h576a32 32 0 0 1 32 32v96h164.544a32 32 0 0 1 31.616 27.136l54.144 352A32 32 0 0 1 922.688 736h-91.52a144 144 0 1 1-286.272 0H415.104a144 144 0 1 1-286.272 0z m23.36-64a143.872 143.872 0 0 1 239.488 0H568.32c17.088-25.6 42.24-45.376 71.744-55.808V256H128v416z m655.488 0h77.632l-19.648-128H704v64.896A144 144 0 0 1 807.744 672m48.128-192l-14.72-96H704v96zM688 832a80 80 0 1 0 0-160 80 80 0 0 0 0 160m-416 0a80 80 0 1 0 0-160 80 80 0 0 0 0 160"
                        p-id="6164"></path>
                </svg>
                <span class="delivery-time">48小时内发货</span>
                <span class="delivery-cash">快递: 免运费</span>
                <span class="delivery-address">广东深圳 至 南京 浦口</span>
            </div>
            <div class="goods-aftersales-tag-box">
                <svg t="1762181273549" class="icon" viewBox="0 0 1024 1024" version="1.1"
                    xmlns="http://www.w3.org/2000/svg" p-id="9862" width="200" height="200">
                    <path
                        d="M192.1 585.5c-6.6 0-13.1-2.6-18.1-7.7L103.3 504c-9.6-10-9.2-25.8 0.7-35.3 10-9.6 25.8-9.2 35.3 0.7l70.8 73.9c9.6 10 9.2 25.8-0.7 35.3-4.8 4.6-11.1 6.9-17.3 6.9z m8.5 6c-6.7 0-13.3-2.6-18.2-7.9-9.4-10.1-8.9-25.9 1.1-35.3l78.7-73.8c10.1-9.4 25.9-8.9 35.3 1.1 9.4 10.1 8.9 25.9-1.1 35.3l-78.7 73.8c-4.8 4.5-10.9 6.8-17.1 6.8z m343.9 295.2c-16.6 0-30-13.4-30-30s13.4-30 30-30c174.1 0 315.7-141.6 315.7-315.7S718.6 195.2 544.5 195.2 228.8 336.8 228.8 510.9c0 16.6-13.4 30-30 30s-30-13.4-30-30c0-50.7 9.9-99.9 29.5-146.3 18.9-44.7 46-84.9 80.5-119.4s74.7-61.6 119.4-80.5c46.3-19.6 95.6-29.5 146.3-29.5s99.9 9.9 146.3 29.5c44.7 18.9 84.9 46 119.4 80.5s61.6 74.7 80.5 119.4c19.6 46.3 29.5 95.6 29.5 146.3s-9.9 99.9-29.5 146.3c-18.9 44.7-46 84.9-80.5 119.4s-74.7 61.6-119.4 80.5c-46.3 19.7-95.5 29.6-146.3 29.6z m124.7-359.5H431.1c-16.6 0-30-13.4-30-30s13.4-30 30-30h238.1c16.6 0 30 13.4 30 30s-13.5 30-30 30z m-1 102H430.1c-16.6 0-30-13.4-30-30s13.4-30 30-30h238.1c16.6 0 30 13.4 30 30s-13.4 30-30 30zM549.1 745.7c-16.6 0-30-13.4-30-30V497.2c0-16.6 13.4-30 30-30s30 13.4 30 30v218.5c0 16.5-13.4 30-30 30z m1.1-242.5c-7.9 0-15.8-3.1-21.7-9.3L413.6 373.4c-11.4-12-11-31 1-42.4s31-11 42.4 1l114.9 120.5c11.4 12 11 31-1 42.4-5.8 5.6-13.2 8.3-20.7 8.3z m-1.6-0.9c-7.6 0-15.3-2.9-21.1-8.7-11.8-11.7-11.9-30.6-0.2-42.4l120.2-121.5c11.7-11.8 30.7-11.9 42.4-0.2 11.8 11.7 11.9 30.6 0.2 42.4L569.9 493.4c-5.8 6-13.5 8.9-21.3 8.9z"
                        fill="#333333" p-id="9863"></path>
                </svg>
                <span class="aftersales-time">7天无理由退货</span>
                <dividline style="margin-inline: 5px;" />
                <span class="aftersales-cashBaby">退货宝</span>
                <dividline style="margin-inline: 5px;" />
                <span class="aftersales-instanceRefund">极速退款</span>
            </div>
            <div class="goods-payment-tag-box">
                <svg t="1762181333318" class="icon" viewBox="0 0 1024 1024" version="1.1"
                    xmlns="http://www.w3.org/2000/svg" p-id="12709" width="200" height="200">
                    <path
                        d="M859.382496 864.714934 164.617504 864.714934c-55.904586 0-101.488325-45.583739-101.488325-101.488325L63.129179 260.773392c0-55.904586 45.583739-101.488325 101.488325-101.488325l694.764992 0c55.904586 0 101.488325 45.583739 101.488325 101.488325l0 502.453217C960.870821 819.131194 915.287082 864.714934 859.382496 864.714934zM164.617504 223.44633c-20.641693 0-37.499076 16.685369-37.499076 37.327062l0 502.453217c0 20.641693 16.685369 37.327062 37.499076 37.327062l694.764992 0c20.641693 0 37.499076-16.685369 37.499076-37.327062L896.881572 260.773392c0-20.641693-16.685369-37.327062-37.499076-37.327062L164.617504 223.44633 164.617504 223.44633z"
                        fill="#2c2c2c" p-id="12710"></path>
                    <path
                        d="M800.55367 415.758105 223.44633 415.758105c-17.717453 0-31.994625-14.449185-31.994625-31.994625 0-17.717453 14.449185-31.994625 31.994625-31.994625l577.279355 0c17.717453 0 31.994625 14.449185 31.994625 31.994625C832.720309 401.480934 818.271124 415.758105 800.55367 415.758105z"
                        fill="#2c2c2c" p-id="12711"></path>
                    <path
                        d="M319.602217 736.392407l-96.155888 0c-17.717453 0-31.994625-14.277171-31.994625-31.994625 0-17.717453 14.449185-31.994625 31.994625-31.994625l96.155888 0c17.717453 0 31.994625 14.277171 31.994625 31.994625C351.596842 722.115236 337.319671 736.392407 319.602217 736.392407z"
                        fill="#2c2c2c" p-id="12712"></path>
                </svg>
                <span class="payment-method">信用卡支付</span>
            </div>
        </div>
        <div class="goods-color-category-box">
            <div class="goods-color-category-title">颜色分类</div>
            <div class="goods-color-category-list">
                <div class="goods-color-opition" v-for="item, index in colorOpitons" :key="index">
                    <img class="goods-color-opition-img" src="" alt="">
                    <span class="goods-color-opition-name">{{ item }}</span>
                </div>
            </div>
        </div>
        <div class="goods-buy-box">
            <span class="goods-buy-num-title">数量</span>
            <div class="goods-buy-num-button-box">
                <span class="goods-buy-num-botton-minus" @click="buyNumMinus">
                    <svg t="1762186590994" class="icon" viewBox="0 0 1024 1024" version="1.1"
                        xmlns="http://www.w3.org/2000/svg" p-id="8597" width="200" height="200">
                        <path
                            d="M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"
                            p-id="8598"></path>
                    </svg>
                </span>
                <span class="goods-buy-num-value">
                    <input type="text" v-model="buyNum">
                </span>
                <span class="goods-buy-num-botton-plus" @click="buyNumPlus">
                    <svg t="1762186572676" class="icon" viewBox="0 0 1024 1024" version="1.1"
                        xmlns="http://www.w3.org/2000/svg" p-id="15060" width="200" height="200">
                        <path d="M474 152m8 0l60 0q8 0 8 8l0 704q0 8-8 8l-60 0q-8 0-8-8l0-704q0-8 8-8Z" fill="#000000"
                            p-id="15061"></path>
                        <path d="M168 474m8 0l672 0q8 0 8 8l0 60q0 8-8 8l-672 0q-8 0-8-8l0-60q0-8 8-8Z" fill="#000000"
                            p-id="15062"></path>
                    </svg>
                </span>
            </div>
            <span class="goods-buy-num-lack">即将售罄</span>
        </div>
        <div class="goods-insurance-box">
            <div class="goods-insurance-title">保障服务</div>
            <div class="goods-insurance-choice">选择更多</div>
        </div>
        <div class="goods-action-button-box" ref="actionButtonBox">
            <el-button class="goods-action-button-addCart">加入购物车</el-button>
            <el-button class="goods-action-button-buyNow">立即购买</el-button>
            <div class="goods-action-button-collect">
                <svg t="1762184742493" class="icon" viewBox="0 0 1059 1024" version="1.1"
                    xmlns="http://www.w3.org/2000/svg" p-id="13751" width="200" height="200">
                    <path
                        d="M253.488042 1024c-16.9 0-33.2875-5.1125-47.6125-15.3625-26.625-18.425-39.425-49.6625-34.3125-81.925l40.9625-251.9c1.5375-10.2375-1.5375-20.475-8.7-27.65L28.213042 466.4375c-22.0125-22.525-29.1875-55.3-19.45-84.9875 9.725-29.7 35.325-51.2 66.05-55.8125l237.575-36.35c10.75-1.5375 19.4625-8.1875 24.0625-17.925L441.388042 48.125c13.825-29.7 42.5-48.125 75.2625-48.125s61.4375 18.4375 75.2625 48.125l104.45 223.2375c4.6125 9.725 13.825 16.375 24.0625 17.925L958.000542 325.625a82.355 82.355 0 0 1 66.05 55.8125c10.2375 29.7 2.5625 62.4625-19.45 84.9875l-175.625 180.7375c-7.1625 7.175-10.2375 17.925-8.7 27.65l40.9625 251.9c5.125 31.75-8.1875 63.4875-34.3 81.925-26.1125 18.4375-59.9 20.4875-88.0625 4.6125l-206.85-114.6875c-9.725-5.1125-20.9875-5.1125-30.7125 0l-207.3625 115.2c-12.8125 6.65-26.6375 10.2375-40.4625 10.2375zM516.650542 51.2c-12.8 0-23.55 7.1625-29.1875 18.4375L383.525542 292.875c-11.775 25.0875-35.325 43.0125-62.975 47.1l-237.575 36.35c-12.2875 2.05-21.5 9.7375-25.6 21.5-4.1 11.775-1.025 24.0625 7.675 32.775L240.688042 611.325c18.4375 18.95 26.625 45.5625 22.525 71.675L222.250542 934.9125c-2.05 12.8 3.075 24.575 13.3125 31.7375 10.2375 7.175 23.0375 7.6875 33.7875 1.5375l207.3625-115.2c25.0875-13.825 55.3-13.825 80.3875 0l207.3625 115.2c10.75 6.1375 23.55 5.625 33.8-1.5375 10.2375-7.1625 15.3625-18.95 13.3125-31.7375L770.625542 683.0125c-4.1-26.1125 4.1-52.7375 22.525-71.675l175.625-180.7375c8.7-8.7 11.2625-20.9875 7.675-32.775-4.0875-11.775-13.3125-19.9625-25.6-21.5l-237.5625-36.35c-27.65-4.0875-51.2-22.0125-62.975-47.1L545.838042 69.6375c-5.625-11.2625-16.375-18.4375-29.1875-18.4375z m0 0"
                        p-id="13752" fill="#2c2c2c"></path>
                </svg>
                <span>收藏</span>
            </div>
        </div>
    </div>
</template>

<script setup>
import dividline from '@/views/Login/components/dividline.vue';
import { ref, onMounted, onUnmounted, nextTick } from 'vue';

const buyNum = ref(1);

function buyNumMinus() {
    if (buyNum.value > 1) {
        buyNum.value--;
    }
}

function buyNumPlus() {
    buyNum.value++;
}

const colorOpitons = ref([
    '8新以下深空灰色（闪电口）【 店保一年 】',
    '8新深空灰色（闪电口）【 店保一年 】',
    '9新深空灰色（闪电口）【 店保一年 】',
    '95新深空灰色（闪电口）【 店保一年 】',
    '99新深空灰色（闪电口）【 店保一年 】',
    '9新天蓝色（闪电口）【 店保一年 】',
    '99新天蓝色（闪电口）【 店保一年 】',
    '99新银色（闪电口）【 店保一年 】',
    '95新银色（闪电口）【 店保一年 】',
    '99新午夜色（USB-C）【 店保一年 】',
    '95新午夜色（USB-C）【 全国联保 】',
    '95新紫色（USB-C）【 全国联保 】',
    '9新银色（闪电口）【 店保一年 】',
    '8新银色（闪电口）【 店保一年 】'
])

const actionButtonBox = ref(null)
const rightBuyBox = ref(null)

const updateButtonPosition = () => {
    if (actionButtonBox.value && rightBuyBox.value) {
        const parentRect = rightBuyBox.value.getBoundingClientRect()
        actionButtonBox.value.style.width = `${parentRect.width}px`
        actionButtonBox.value.style.left = `${parentRect.left}px`
    }
}

onMounted(async () => {
    // 等待 DOM 更新
    await nextTick()
    updateButtonPosition()
    window.addEventListener('resize', updateButtonPosition)
    window.addEventListener('scroll', updateButtonPosition, true)
})

onUnmounted(() => {
    window.removeEventListener('resize', updateButtonPosition)
    window.removeEventListener('scroll', updateButtonPosition, true)
})
</script>

<style>
.right-buy-box {
    min-width: 360px;
    margin-top: 30px;
    width: 40%;
    margin-left: 48px;
    height: calc(100vh - 30px);
    overflow-y: auto;
    overflow-x: hidden;
    padding-bottom: 100px;
}

.right-buy-box::-webkit-scrollbar {
    width: 4px;
}

.right-buy-box::-webkit-scrollbar-thumb {
    background: var(--color-gray-dark);
    /* 滑块颜色 */
    border-radius: 10px;
    /* 创建间距效果 */
}

.right-buy-box::-webkit-scrollbar-thumb:hover {
    background: var(--color-gray-darker);
    /* 悬停颜色 */
}

.goods-name-box {
    display: flex;
    width: 100%;
}

.goods-name {
    font-size: 20px;
    font-weight: 600;
}

.goods-custom-tag-box {
    margin-top: 10px;
    display: flex;
    align-items: center;
    width: 100%;
    height: 30px;
}

.goods-custom-tag {
    font-size: 14px;
    color: gray;
    background-color: var(--color-gray);
    height: 28px;
    line-height: 28px;
    padding-inline: 8px;
    border-radius: 5px;
    margin-right: 10px;
}

.goods-price-box {
    width: 100%;
    height: 30px;
    margin-top: 10px;
}

.goods-price-unit {
    color: var(--color-orange);
    font-size: 16px;
    font-weight: 600;
}

.goods-price-value {
    font-size: 24px;
}

.goods-sales {
    font-size: 14px;
    margin-left: 10px;
    color: gray;
}

.goods-sales-value {
    font-size: 14px;
    margin-left: 5px;
}

.goods-price-tag-box {
    margin-top: 10px;
    width: 100%;
    height: 30px;
    display: flex;
}

.goods-buy-tag-box {
    margin-top: 20px;
    width: 100%;
    height: 90px;
}

.goods-price-tag {
    padding-inline: 10px;
    height: 100%;
    border-radius: 10px;
    background-color: var(--color-lighter);
    color: var(--color-dark);
    font-size: 14px;
    font-weight: 600;
    line-height: 30px;
}

.delivery-time {
    margin-left: 5px;
    font-size: 14px;
    white-space: nowrap;
}

.delivery-cash {
    font-size: 13px;
    margin-left: 10px;
    white-space: nowrap;
}

.delivery-address {
    font-size: 14px;
    margin-left: 10px;
    white-space: nowrap;
}

.goods-delivery-tag-box,
.goods-aftersales-tag-box,
.goods-payment-tag-box {
    width: 100%;
    height: 30px;
    display: flex;
    align-items: center;
}

.goods-delivery-tag-box .icon {
    width: 20px;
    height: 20px;
}

.goods-aftersales-tag-box .icon {
    width: 20px;
    height: 20px;
}

.goods-payment-tag-box .icon {
    width: 20px;
    height: 20px;
}

.aftersales-time {
    margin-left: 5px;
    font-size: 14px;
}

.aftersales-cashBaby {
    font-size: 14px;
}

.aftersales-instanceRefund {
    font-size: 14px;
}

.payment-method {
    font-size: 14px;
    margin-left: 5px;
}

.goods-color-category-box {
    margin-top: 10px;
    border-top: solid 1px var(--color-gray-dark);
    width: 100%;
    display: flex;
    flex-direction: column;
}

.goods-color-category-title {
    margin-top: 20px;
    font-size: 14px;
    color: gray;
}

.goods-color-category-list {
    margin-top: 10px;
    width: 100%;
    display: flex;
    flex-direction: column;
}

.goods-color-opition {
    margin-bottom: 10px;
    border-radius: 10px;
    padding-top: 10px;
    padding-bottom: 5px;
    padding-inline: 15px;
    width: fit-content;
    display: flex;
    align-items: center;
    border: solid 1px var(--color-gray-dark);

}

.goods-color-opition-img {
    width: 20px;
    height: 20px;
}

.goods-color-opition-name {
    font-size: 14px;
    margin-left: 5px;
}

.goods-color-opition:hover {
    cursor: pointer;
    border: solid 1px var(--color-normal);
}

.goods-color-opition:hover .goods-color-opition-name {
    color: var(--color-normal);
}

.goods-color-opition-active {
    border: solid 1px var(--color-normal);
}

.goods-color-opition-active .goods-color-opition-name {
    color: var(--color-normal);
}

.goods-action-button-box {
    padding-left: 20px;
    padding-right: 10px;
    height: 70px;
    background-color: white;
    box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.1);
    border-radius: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: fixed;
    bottom: 20px;
    z-index: 10;
}

.goods-action-button-addCart {
    border: none;
    height: 50px;
    flex: 1;
    background-color: var(--color-normal);
    color: white;
    margin-right: 0 !important;
    border-radius: 10px 0 0 10px;
}

.goods-action-button-buyNow {
    border: none;
    height: 50px;
    flex: 1;
    background-color: var(--color-light);
    color: white;
    margin-left: 0 !important;
    border-radius: 0 10px 10px 0px;
}

.goods-action-button-collect {
    cursor: pointer;
    margin-left: 10px;
    width: 50px;
    height: 50px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.goods-action-button-collect:hover span {
    color: var(--color-normal);
}

.goods-action-button-collect:hover .icon path {
    fill: var(--color-normal);
}

.goods-action-button-collect span {
    font-size: 12px;
    margin-top: 3px;
}

.goods-action-button-collect .icon {
    width: 20px;
    height: 20px;
}

.goods-buy-box {
    width: 100% !important;
    height: 50px;
    display: flex;
    align-items: center;
}

.goods-buy-num-title {
    width: 60px;
    color: var(--color-gray-darker);
    font-size: 14px;
}

.goods-buy-num-button-box {
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-left: 10px;
}

.goods-buy-num-botton-minus,
.goods-buy-num-botton-plus {
    cursor: pointer;
    border: solid 1px var(--color-gray-dark);
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.goods-buy-num-botton-minus {
    border-right: none;
    border-radius: 10px 0 0 10px;
}

.goods-buy-num-botton-plus {
    border-left: none;
    border-radius: 0 10px 10px 0;
}

.goods-buy-num-value {
    width: 50px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: solid 1px var(--color-gray-dark);
}

.goods-buy-num-value input {
    border: none;
    outline: none;
    width: 100%;
    padding-inline: 10px;
    text-align: center;
    font-size: 16px;
    font-weight: 600;
}

.goods-buy-num-lack {
    font-size: 16px;
    margin-left: 10px;
    color: gray;
}

.goods-buy-num-botton-minus .icon,
.goods-buy-num-botton-plus .icon {
    width: 20px;
    height: 20px;
}

.goods-insurance-box {
    width: 100%;
    height: 50px;
    display: flex;
    align-items: center;
}

.goods-insurance-title {
    width: 60px;
    font-size: 14px;
    color: var(--color-gray-darker);
}

.goods-insurance-choice {
    font-size: 14px;
    color: var(--color-normal);
    margin-left: 10px;
    cursor: pointer;
}
</style>